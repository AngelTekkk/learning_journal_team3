<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Übersicht aller Einträge</title>
</head>
<body>
<h1>Hier ist eine Übersicht aller Einträge</h1>
<div>
    <h2>Nach was möchtest du deine Einträge Filtern</h2>
    <div>
    <form th:action="@{/entries}" th:object="${filter}" method="get">

    <label for="topic">Themafilter:</label>
    <select id="topic" name="topic">
        <option value="" selected>---</option>
        <option th:each="topic : ${topics}"
                th:value="${topic.id}"
                th:text="${topic.name}"></option>
    </select>

    <label for="person">Personenfilter:</label>
    <select id="person" name="personType">

    <option value="all" selected>---</option>
    <option value="me">Mich</option>
    </select>
    <button type="submit">Anzeigen</button>
    </form>
    </div>
    <table>
        <thead>
        <tr>
            <th>Titel</th>
            <th>Inhalt</th>
            <th>Thema</th>
            <th>Datum</th>
            <th>Aktionen</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="entry: ${entries}">
            <td th:text="${entry.title}">Titel</td>
            <td th:text="${entry.content}">Inhalt</td>
            <td th:text="${entry.topic.name}">Thema</td>
            <td th:text="${#temporals.format(entry.date, 'yyyy-MM-dd')}">Datum</td>
            <td th:if="${#authorization.expression('hasRole(''ADMIN'')')} or
            ( ${#authorization.expression('hasRole(''USER'')')} and ${userId} == ${entry.user.id})">
                <a th:href="@{/newEntry/{id}(id=${entry.id})}" >Bearbeiten</a>
                <form th:action="@{/entry/delete}" method="post"
                      onsubmit="return confirm('Sind Sie sicher, dass Sie diesen Eintrag löschen möchten?');">
                    <input type="hidden" name="entryId" th:value="${entry.id}" />
                    <button type="submit">Löschen</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>
</div>
<div>
    <a th:href="@{/newEntry}">Neuen Eintrag erstellen</a>
</div>
<div>
    <a th:href="@{/welcome}" class="btn btn-primary">Zurück zur Welcomeseite</a>
</div>
</body>
</html>